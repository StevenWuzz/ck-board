<h1 mat-dialog-title *ngIf="!editingPost">Add Post</h1>
<h1 mat-dialog-title *ngIf="editingPost">Update Post</h1>
<div mat-dialog-content>
  <mat-form-field appearance="fill" style="width: 100%">
    <mat-label>Title</mat-label>
    <input
      name="title"
      [appAutofocus]="true"
      [formControl]="titleControl"
      [errorStateMatcher]="matcher"
      matInput
      autocomplete="off"
      [(ngModel)]="title"
    />
    <mat-error *ngIf="!title"> Title is <strong>required</strong> </mat-error>
    <mat-error *ngIf="title && title.length > 50">
      Title is <strong>too long!</strong>
    </mat-error>
  </mat-form-field>

  <div *ngIf="questionAuthoringType === 'OPEN_RESPONSE'" >
    <mat-form-field appearance="fill" style="width: 100%">
      <mat-label>Add open response question prompt</mat-label>
      <textarea
        [formControl]="msgControl"
        [errorStateMatcher]="matcher"
        matInput
        rows="5"
        cols="40"
        [(ngModel)]="message"
      ></textarea>
      <mat-error *ngIf="message && message.length > 1000">
        Message is <strong>too long!</strong>
      </mat-error>
    </mat-form-field>
  </div>

  <div *ngIf="questionAuthoringType === 'MULTIPLE_CHOICE'" style="position: relative;">
    <div>
      <mat-form-field 
        appearance="outline"
        style="width: 90%"
      >
        <mat-label>New Multiple Choice Option</mat-label>
        <input 
          matInput 
          [(ngModel)]="newMultipleChoiceOptionTest" 
        />
        <mat-error *ngIf="!newMultipleChoiceOptionTest"> Option is <strong>required</strong> </mat-error>
        <mat-error *ngIf="newMultipleChoiceOptionTest && newMultipleChoiceOptionTest.length > 50">
          Option is <strong>too long!</strong>
        </mat-error>
      </mat-form-field>
      <button
        mat-mini-fab
        *ngIf="multipleChoiceOptions.length < 6"
        style="margin: 0 10px;"
        color="accent"
        [disabled]="!newMultipleChoiceOptionTest || multipleChoiceOptions.length > 50"
        matTooltip="Add Multiple Choice Option"
        matTooltipPosition="before"
        (click)="addMultipleChoiceButton()"
      >
        <mat-icon>add</mat-icon>
      </button>
    </div>
    <div>
      <mat-card 
        *ngFor="let multipleChoice of multipleChoiceOptions" 
        style="display:flex;margin: 10px;padding: 10px;justify-content:space-between"
        [ngStyle]="{ 'background-color': multipleChoice.correct ? '#39e75f' : 'white' }"
      >
        <mat-card-title style="font-size: small;margin:auto 0;">
          {{ multipleChoice.optionTitle }}
        </mat-card-title>
        <div>
          <button
            mat-mini-fab
            style="margin: 0 10px;"
            color="accent"
            matTooltip="Delete"
            matTooltipPosition="before"
            (click)="removeMultipleChoiceOption($event, multipleChoice)"
          >
            <mat-icon class="editMultipleChoiceOptions">
              delete
            </mat-icon>
          </button>
          <button
            mat-mini-fab
            style="margin: 0 10px;"
            color="accent"
            matTooltip="Correct Option"
            matTooltipPosition="before"
            (click)="multipleChoiceAnswer($event, multipleChoice)"
          >
            <mat-icon class="editMultipleChoiceOptions">
              check_circle_outline
            </mat-icon>
          </button>
        </div>
      </mat-card>
    </div>
  </div>
  <mat-form-field *ngIf="!editingPost" class="tag-form" appearance="standard">
    <mat-chip-list #chipList>
      <mat-chip style="background-color: #78c2c0" [matMenuTriggerFor]="menu1">
        Add Tag
        <mat-icon>add</mat-icon>
      </mat-chip>
      <mat-chip
        [ngStyle]="{ 'background-color': tag.color }"
        *ngFor="let tag of tags"
      >
        {{ tag.name }}
        <mat-icon class="cancel" (click)="removeTag(tag)">cancel</mat-icon>
      </mat-chip>
      <mat-menu #menu1="matMenu">
        <div mat-menu-item *ngIf="tagOptions && tagOptions.length == 0">
          No tags available.
        </div>
        <div
          mat-menu-item
          (click)="addTag($event, tagOption)"
          *ngFor="let tagOption of tagOptions"
        >
          {{ tagOption.name }}
        </div>
      </mat-menu>
    </mat-chip-list>
  </mat-form-field>
</div>
<div mat-dialog-actions>
  <button mat-button (click)="onNoClick()">Cancel</button>
  <button
    *ngIf="!editingPost"
    type="submit"
    [disabled]="disabled()"
    mat-button
    (click)="handleDialogSubmit()"
    cdkFocusInitial
  >
    Add Post
  </button>
  <button
    *ngIf="editingPost"
    type="submit"
    [disabled]="disabled()"
    mat-button
    (click)="updateMultipleChoicePost()"
    cdkFocusInitial
  >
    Update Post
  </button>
</div>
